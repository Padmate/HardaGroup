@using HardaGroup.Utility;
@using HardaGroup.Models;
@{
    Layout = null;
    var aboutSearch = (M_AboutSearch)ViewData["AboutSearch"];    
}
<div class="close-modal" data-dismiss="modal">
    <i class="fa fa-3x fa-close"></i>
</div>
<div class="container">

    <h3 class="customer-h3 text-center curd-title">Edit</h3>
    <hr />
    <div class="form-horizontal">
        <div class="form-group">
            <div class="col-md-2 control-label">
                <label class="customer-content-sm">类别代码：</label>
            </div>
            <div class="col-md-10">
                <input class="input-large" id="tbTypeCode" placeholder="类别代码" value="@aboutSearch.TypeCode" />
                <label class="text-red">代码将以URI形式出现在URL中</label> 
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-2 control-label">
                <label class="customer-content-sm">类别名称：</label>
            </div>
            <div class="col-md-10">
                <input class="input-large" id="tbTypeName" placeholder="类别名称" value="@aboutSearch.TypeName"/>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-2 control-label">
                <label class="customer-content-sm">顺 序：</label>
            </div>
            <div class="col-md-10">
                <input class="input-large" id="tbSequence" placeholder="顺 序" value="@aboutSearch.Sequence"/>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-2 control-label">
                <label class="customer-content-sm">内 容：</label>
            </div>
            <div class="col-md-10">
                <textarea id="taContent" name="content">@aboutSearch.Content</textarea>

            </div>
        </div>

    </div>

</div>
<div class="modal-footer">
    <button type="button" class="btn btn-lg btn-info"
            data-dismiss="modal">
        退 出
    </button>
    <button type="button" class="btn btn-lg btn-danger" onclick="SaveAdd()">
        保 存
    </button>
</div>

<script type="text/javascript">
    var editor = KindEditor.create('textarea[name="content"]',kindeditorConfig);

    //修改或新增保存
    function SaveAdd() {

        $("body").showLoading();
        var saveObj = ConstructSaveObj();
        var jsonParam = JSON.stringify(saveObj);
        $.ajax({
            type: "POST",
            url: "/About/SaveEdit",
            dataType: "json",
            data: jsonParam,
            async: false,   //同步
            success: function (message) {

                if (message.Success) {

                    //刷新表格
                    CloseEditScreen();
                    //刷新
                    RefreshTable();
                    $("body").hideLoading();


                } else {
                    $("body").hideLoading();

                    layer.alert(message.Content, {
                        skin: 'layui-layer-molv' //样式类名
                      , closeBtn: 0
                    });
                    return;
                }
            }
        });
    }


    //构造保存对象
    function ConstructSaveObj() {

        //默认新增国际化为中文 信息
        var aboutGlobalization = {
            AboutId: '@aboutSearch.Id',
            TypeName: $("#tbTypeName").val(),
            Content: editor.html(),
            Culture: '@aboutSearch.Culture'
        };
        var arrAboutGlobalization = new Array();
        arrAboutGlobalization.push(aboutGlobalization);


        var obj = {
            Id:'@aboutSearch.Id',
            TypeCode: $("#tbTypeCode").val(),
            Sequence: $("#tbSequence").val(),
            AboutGlobalizations: arrAboutGlobalization

        };
        return obj;
    }

</script>


