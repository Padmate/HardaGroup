@using Microsoft.AspNet.Identity
@using System.Configuration;
@using HardaGroup.Utility;
@using HardaGroup.Web.Globalization;
@using HardaGroup.Service;
@{
    var title = "HARDA|华尔达集团";
    if (!string.IsNullOrEmpty(ViewBag.Title))
    {
        title = ViewBag.Title + "|" + title;
    }
    
    var urlRewriteExtension = ConfigurationManager.AppSettings["UrlRewriteExtension"];
    
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Padmate Allen">

    <title>@title</title>
    <link rel="shortcut icon" href="~/images/favicon.png" />
    <link rel="stylesheet" href="~/Content/font-awesome.min.css">
    <link rel="stylesheet" href="~/Content/bootstrap.css">
    <link rel="stylesheet" href="~/Content/bootstrap-table.css">
    <link rel="stylesheet" href="~/Content/customer-bootstrap-table.css">
    <!-- Custom styles for our template -->
    <link rel="stylesheet" href="~/Content/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="~/Content/animate.css">
    <link rel="stylesheet" href="~/Content/Common.css">
    <link rel="stylesheet" href="~/fonts/font-awesome/css/font-awesome.min.css">

    <link rel="stylesheet" href="~/Content/admin.css">
    <link rel="stylesheet" href="~/Content/admin-skin.css">
    <link rel="stylesheet" href="~/Scripts/loading/showLoading.css">
    <link rel="stylesheet" href="~/Content/tooltip.css">
    <link rel="stylesheet" href="~/Scripts/layer/layer-v2.4/skin/layer.css"/>


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/bootstrap-table/bootstrap-table.js"></script>
    <script src="~/Scripts/bootstrap-table/bootstrap-table-zh-CN.js"></script>
    <script src="~/Scripts/bootstrap-table/customer-bootstrap-table.js"></script>
    <script src="~/Scripts/bootstrap-paginator.js"></script>

    <!--Bootstrap Table Filter-->
    <script src="~/Scripts/bootstrap-table/filter-control/bootstrap-table-filter-control.js"></script>
    <!--Bootstrap Table Export-->
    <script src="~/Scripts/bootstrap-table/export/bootstrap-table-export.min.js"></script>
    <script src="~/Scripts/bootstrap-table/export/tableExport.min.js"></script>


    <script src="~/Scripts/layer/layer-v2.4/layer.js"></script>
    <script src="~/Scripts/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
    <script src="~/Scripts/bootstrap-datetimepicker/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script src="~/Scripts/bootstrap-datetimepicker/customer-datetimepicker.js"></script>
    <script src="~/Scripts/dateformathelp.js"></script>
    <script src="~/Scripts/loading/jquery.showLoading.js"></script>

    <!-- AdminLTE App -->
    <script src="~/Scripts/admin/app.js"></script>
    <script src="~/Scripts/Globalization.js"></script>

    <link rel="stylesheet" href="~/kindeditor/themes/default/default.css" />
    <link rel="stylesheet" href="~/kindeditor/plugins/code/prettify.css" />
    <script charset="utf-8" src="~/kindeditor/kindeditor.js"></script>
    <script charset="utf-8" src="~/kindeditor/lang/zh_CN.js"></script>
    <script charset="utf-8" src="~/kindeditor/plugins/code/prettify.js"></script>
    <script charset="utf-8" src="~/kindeditor/kindeditor-config.js"></script>
    <script src="~/Scripts/data-operater.js"></script>
    <script src="~/Scripts/jquery.placeholder.js"></script>


</head>
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

        <header class="main-header">
            <!-- Logo -->
            <a href="/" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><b>Har</b>da</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>Harda</b>Group</span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                </a>

                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">

                                                <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">

                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="~/images/loginuser.jpg" class="user-image" alt="User Image">
                                <span class="hidden-xs">
                                @User.Identity.GetUserName()
                                </span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                <li class="user-header">
                                    <img src="~/images/loginuser.jpg" class="img-circle" alt="User Image">

                                    <p>
                                        欢迎登录华尔达后台管理 - @User.Identity.GetUserName()
                                        <small>@DateTime.Now</small>
                                    </p>
                                </li>
                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="row">
                                        <div class="col-xs-4 text-center">
                                            <a href="@string.Format("/manage/changepassword{0}",urlRewriteExtension)">修改密码</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="#">Sales</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="#">Friends</a>
                                        </div>
                                    </div>
                                    <!-- /.row -->
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="@string.Format("/manage/userinfo{0}",urlRewriteExtension)" 
                                           class="btn btn-default btn-flat">用户信息</a>
                                    </div>
                                    <div class="pull-right">
                                        @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm" }))
                                        {
                                            @Html.AntiForgeryToken()
                                            <a href="javascript:document.getElementById('logoutForm').submit()" class="btn btn-default btn-flat">注销</a>

                                        }

                                    </div>
                                </li>
                            </ul>
                            
                        </li>

                    </ul>
                </div>
            </nav>
        </header>
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                @if (User.IsInRole(SystemRole.SystemAdmin) || User.IsInRole(SystemRole.BackstageAdmin))
                {
                    @Html.Partial("_AdminMenu")

                }
                else
                {
                    @Html.Partial("_NormalMenu")
                }
                
            </section>
            <!-- /.sidebar -->
        </aside>

        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                   
                    <small>@ViewBag.Title</small>
                </h1>
            </section>
            @RenderBody()
            <!-- Main content -->
            <!-- /.content -->
        </div>

        
    </div>
    
    <script>
        $(function () {

            //当前访问路径
            var url = window.location;
            var element = $('.sidebar-menu a').filter(function () {
                return this.href == url || url.href.indexOf(this.href) == 0;
            }).parent().addClass('active').parent().parent();
            if (element.is('li')) {

                element.addClass('active');
                //三级菜单
                var thelement = element.parent().parent();
                if (thelement.is('li'))
                {
                    thelement.addClass('active');
                }
            }

            //$(".sidebar-menu a").click(function () {
            //    event.preventDefault();
            //    if(this.pathname !="void(0)")
            //    {
            //        alert(this.pathname);

            //    }
            //});
        });
    </script>

</body>
</html>
